# 2.1 REST API

## Multitier architecture (다층 구조)

- 비즈니스 로직을 완전히 분리하여 데이터베이스 시스템과 클라이언트 사이에 배치한 클라이언트 서버시스템의 일종
- 일반적으로 3층 구조가 널리 쓰이는데, 3층이란 아래와 같이 각각 독립된 모듈로 개발되고 유지되는 구조로, 이들은 각각 다른 플랫폼 상에서 구동된다.
  - 사용자 인터페이스(Presentation tier)
  - 비즈니스 로직(Logic tier)
  - 데이터베이스(Data tier)

## Front-End와 Back-end

- 우리는 시스템을 만들 때 프로그램을 여러 Tier 혹은 Layer로 나누어 구분한다.

  - Tier : 물리적인 구분
  - Layer : 논리적인 구분(UI를 주로 다루는 layer.. 등)

- Front-End : 사용자에 가까운 부분 (클라이언트)
- Back-End : 사용자에게서 먼 부분 (서버)
- F/E와 B/E를 연결하는 여러가지 방법 : HTTP(Web 기술), REST API, SOAP, GraphQL

## REST란?(Respresentational State Transfer)

네트워크 기반의 소프트웨어 아키텍처를 위한 아키텍처 스타일

### 왜 REST를 사용하는가? 1강 11분 쯤

REST가 타 네트워크 기반의 아키텍처와 구별짓는 핵심 포인트 : Uniform interface

### REST라는 이름은 어디서?

표현 상태 전송?
표현(Representation) : Data + MetaData + Meta-metadata.. => 사실상 HTTP 메시지
리소스를 어떻게 조작할 것인가는 HTTP Method로 표현하기 되고, 리소스를 무엇으로 조작할 것인가는 Content-Type과 Body로 표현하게 된다.
json으로 리소스를 조작할 것이라면? Content-Type에 json

Roy Fielding 논문 챕터 5
Architectural Styles and the design of Network-based Software Architectures
7가지 제약조건

## REST와 SOAP의 차이

- REST와 SOAP는 각기 다른 두 가지의 온라인 데이터 전송 방식이다. 둘 다 웹 애플리케이션 간 데이터 통신을 허용하는 API(Application Programming Interface)를 구축하는 방법을 정의한다.
  - REST(Representational State Transfer)는 아키텍처 원칙 세트
  - SOAP(Simple Object Access Protocol)는 W3C(World Wide Web Consortium)에서 유지관리하는 공식 프로토콜이다.
- 대부분의 레거시 시스템에서 SOAP를 준수하며, REST는 그보다 뒤에 고려하거나 웹 기반 시나리오 에서의 더 빠른 대안으로 여기는 경우가 많다.
- REST API는 경량화되어 있기 때문에 사물 인터넷(IoT), 모바일 애플리케이션 개발, 서버리스(servreless) 컴퓨팅과 같이 보다 새로운 컨텍스트에 이상적이다.
- SOAP 웹 서비스는 많은 기업에서 필요로 하는 기본 보안과 트랜잭션 컴플라이언스를 제공하지만, 이로 인해 좀 더 무거운 경향이 있다.
- 또한 Google Maps API와 같은 대부분의 퍼블릭 API는 REST 가이드라인을 따른다.

- **즉 SOAP는 프로토콜이지만, REST는 프로토콜이 아니다.**

### SOAP(Simple Object Access Protocol)

- SOAP는 다른 언어로 다른 플랫폼에서 빌드된 애플리케이션이 통신할 수 있도록 설계된 최초의 표준 프로토콜
- 프로토콜이기 때문에 복잡성과 오버헤드를 증가시키는 빌트인 룰을 적용하므로, 페이지 로드 시간이 길어질 수 있다.
- 그러나 이러한 표준은 빌트인 컴플라이언스를 제공한다는 의미이므로, 기업에서 선호하는 방식이다.
- 빌트인 컴플라이언스 표준에는 보안과 안정적인 데이터베이스 트랜잭션이 기본 속성인 원자성, 일관성, 격리성, 내구성 (ACID)이 포함된다.
- 데이터에 대한 요청이 SOAP API로 전송되는 경우 HTTP(웹 브라우저), SMTP(이메일), TCP 등의 다양한 애플리케이션 레이어 프로토콜을 통해 처리될 수 있다.
- 그러나 요청이 수신되면, 인간과 기계가 모두 읽을 수 있는 마크업 언어인 XML 문서 형식으로 반환하는 SOAP 메시지가 반환된다.
- SOAP API에 대한 완료된 요청은 브라우저에서 캐시할 수 없으므로, API로 재전송하지 않는 한 이후에 액세스 할 수 없다.

---

## GraphQL이란?

- 페이스북에서 만든 쿼리언어
- SQL 또한 쿼리언어이지만, SQL과 GQL의 언어적 구조 차이가 크다.
  - SQL은 데이터베이스 시스템에 저장된 데이터를 효율적으로 가져오는 것이 목적
    - SQL의 문장(statement)은 주로 백엔드 시스템에서 작성하고 호출
  - GQL은 웹 클라이언트가 데이터를 서버로부터 효율적으로 가져오는 것이 목적
    - GQL의 문장은 주로 프론트 엔드에서 작성하고 호출한다.
    - HTTP API 자체가 특정 데이터베이스나 플렛폼에 종속적이지 않은것 처럼 마찬가지로 GQL 역시 어떠한 특정 데이터베이스나 플렛폼에 종속적이지 않다.

### GQL과 REST API와 비교

- REST API는 URL, METHOD 등을 조합하기 때문에 다양한 Endpoint가 존재한다.
- 반면, GQL은 단 하나의 Endpoint가 존재한다.
- Endpoint란?
  - API가 서버에서 리소스에 접근할 수 있도록 가능하게 하는 URL이라 할 수 있다.
  - 커뮤니케이션 채널의 한 쪽 끝, 한마디로 서비스를 이용할 때 사용하는 커뮤니케이션 채널의 한쪽 끝에 해당하는 URI

---

## Apache Tomcat와 Java Servlet

### Apache Tomcat

- 아파치 소프트웨어 재단에서 개발한 서블릿 컨테이너(또는 웹 컨테이너)만 있는 웹애플리케이션 서버(WAS)
- 톰캣은 웹 서버와 연동하여 실행할 수 있는 자바 환경을 제공하여 JSP(Java Server Page)와 자바 서블릿이 실행될 수 있는 환경을 제공하고 있다. 톰캣은 관리툴을 통해 설정을 변경할 수 있지만, XML 파일을 편집하여 설정할 수도 있다. 그리고 톰캣은 HTTP 서버도 자체 내장하기도 한다.

### Java Servlet (자바 서블릿)

일반적으로 웹서버는 정적인 페이지만을 제공한다. 그렇기 때문에 동적인 페이지를 제공하기 위해서는 웹서버는 다른 곳에 도움을 요청하여 동적인 페이지를 작성해야 한다.동적인 페이지는 임의의 이미지만을 보여주는 페이지와 같이 사용자가 요청한 시점에 페이지를 생성해서 전달해 주는 것을 의미한다. 여기서 웹서버가 동적인 페이지를 제공할 수 있도록 도와주는 어플리케이션이 서블릿이다.

- 클라이언트 요청을 처리하고, 그 결과를 반환하는 Servlet 클래스의 구현 규칙을 지킨 자바 웹 프로그래밍 기술
- 서블릿이란 자바를 사용하여 웹을 만들기 위해 필요한 기술
- 클라이언트가 어떠한 요청을 하면 그에 대한 결과를 다시 전송해주어야 하는데, 이러한 역할을 하는 자바 프로그램이 곧 서블릿이다.

- Servlet의 특징
  - 클라이언트의 요청에 대해 동적으로 작동하는 웹 어플리케이션 컴포넌트
  - html을 사용하여 요청에 응답한다.
  - Java Thread를 이용하여 동작한다.
  - MVC 패턴에서 Controller로 이용된다.
  - HTTP 프로토콜 서비스를 지원하는 java.servlet.http.HttpServlet 클래스를 상속받는다.
  - UDP보다 처리 속도가 느리다.
  - HTML 변경 시 Servlet을 재컴파일해야 하는 단점이 있다.

### Servlet Container(서블릿 컨테이너)

우리가 서버에 서블릿을 만들었다고 해서(자바로 servlet을 코딩해서 java파일을 만들었다고 해서) 스스로 작동하는 것이 아니라 서블릿을 관리해주는 것이 필요하다.

- 서블릿을 관리해주는 컨테이너가 서블릿 컨테이너
- 서블릿이 어떤 역할을 수행하는 정의서라고 보면, 서블릿 컨테이너는 그 정의서를 보고 수행한다.
- 서블릿 컨테이너는 클라이언트의 요청(Request)을 받아주고, 응답(Response)할 수 있게, 웹서버와 소켓으로 통신하며 대표적인 예로 Tomcat이 그러하다. Tomcat은 실제로 웹 서버와 통신하여 JSP(자바 서버 페이지)와 Servlet이 작동하는 환경을 제공해준다.

### JSP(Java Server Page)

JSP는 HTML 소스 코드 속에 자바 소스코드가 들어가는 구조를 갖는 웹어플리케이션 프로그래밍 기술이다.
(반면, 서블릿은 자바 소스코드 속에 HTML 코드가 들어가 있는 형태)

- 자바 소스코드로 작성된 HTML의 부분은 웹 브라우저로 보내는 것이 아니라 웹 서버에서 실행된다.
- 웹프로그래머가 소스코드를 수정할 경우에도 디자인 부분을 제외하고 자바 소스코드만 수정하면 되기에 효율을 높여준다.
- 또한 컴파일과 같은 과정을 할 필요없이 JSP 페이지를 작성하여 웹 서버의 디렉토리에 추가만 하면 사용이 가능하다.
- 서블릿 규칙은 꽤나 복잡하기 때문에, JSP가 등장했는데, JSP는 WAS에 의하여 서블릿 클래스로 변환하여 사용된다.

---

## API(Application Programming Interface)

- 두 시스템(애플리케이션 소프트웨어 및 서비스)이 상호작용할 수 있게 하는 툴, 정의, 프로토콜의 총집합
- 프로그램 혹은 시스템 간의 통신하는 창구, 즉 프로그램들이 서로 상호작용하는 것을 도와주는 매개체
- 새로운 연결 인프라를 지속적으로 구축할 필요 없이 제품 및 서비스가 서로 커뮤니케이션할 수 있도록 도와주는 기능
- 컴퓨터나 컴퓨터 프로그램 사이의 연결
- 사용자 인터페이스는 컴퓨터와 인간을 연결시키지만, API는 반대로 컴퓨터와 소프트웨어를 서로 연결한다.
- 직접 사람(최종 사용자)에 의해 사용되도록 고안된 것이 아니며, 대신 소프트웨어에 이를 통합하고자 하는 컴퓨터 프로그래머가 사용하도록 고안되었다.
- API의 한 가지 목적은 시스템이 동작하는 방식에 관한 내부의 세세한 부분을 숨기는 것으로, 내부의 세세한 부분이 나중에 변경되더라도 프로그래머가 유용하게 사용할 수 있고, 일정하게 관리할 수 있는 부분들만 노출시킨다.

## interface란?

- 구현에 대한 것을 다루지 않고, 연결점(signature)만 만들어두고 어떻게 소통하지는 지를 명세한 것
- 객체가 정의하는 연산의 모든 signature들을 일컫는 말
- 객체의 인터페이스는 객체가 받아서 처리할 수 있는 연산의 집합
- signature이란?
  - 객체가 선언하는 모든 연산은 연산의 이름, 매개변수로 받아들이는 객체들, 연산의 반환 값을명 세하는데, 이를 signature라고 한다.
  - 자바 기준 : 메소드 선언 시 사용하는 메소드명, 접근제한자 return 타입을 의미
- interface의 특징
  - Communication
  - Specification
  - Information Hiding (Principle)
  - Encapsulation (Technique)
  - Implementation의 분리

## 정보은닉(Information Hiding)과 캡슐화(Encapsulation)

기술적으로 정보은닉을 달성하는 가장 강력한 방법이 캡슐화

### 정보은닉

- 정보 은닉은 프로그램의 일부분이 자주 바뀔 수 있는 부분과 그렇지 않은 부분을 분리하여 나중에 코드를 바꿔야할 때 큰 노력 없이 할 수 있도록 도와준다.
- 이를 통해, 프로그램 작성 시 변경될 가능성이 있는 세부사항을 숨기고, 다른 프로그램 부분들이 이러한 변경에 영향을 받지 않도록 한다.
- 간단히 말해, 정보 은닉은 프로그램의 일부 정보나 기능을 외부에서 볼 수 없게 하여, 필요한 부분만 사용할 수 있도록 하는 기술이다.

### 캡슐화

- 캡슐화는 정보 은닉과 같은 의미로 자주 사용된다.
- 하지만, 정보 은닉을 원칙으로, 캡슐화를 그 기술로 생각할 수 있다. -캡슐화는 접속부에 해당하는 인터페이스와 그 구현을 분리하는 역할을 한다.
- 분리의 목적은 소스 코드가 변경될 경우를 대비하는 것이다.
- 컴포넌트의 내부 메커니즘이 다른 컴포넌트에 영향을 주지 않고 개선될 수 있다.
- 캡슐화의 또 다른 이점은 시스템 복잡성을 줄이고 소프트웨어 컴포넌트 간의 상호 의존성을 제한함으로써 견고함을 증가시키는 것

## Architecture와 Architecture Style의 차이

- 아키텍처 : 특정 소프트웨어 시스템의 전체적인 구조와 구성을 의미한다. 이는 시스템을 구성하는 컴포넌트들, 그 컴포넌트들 간의 관계, 그리고 이러한 컴포넌트와 관계가 시스템의 목표를 달성하기 위해 어떻게 상호 작용하는지에 대한 설계

- 아키텍처 스타일 : 아키텍처를 설계하는 데 사용할 수 있는 패턴이나 가이드라인이다. 이는 여러 시스템에 걸쳐 재사용될 수 있는 설계의 원칙이나 패턴을 제공한다.

## REST(Representational State Transfer)

- 월드 와이드 웹과 같은 분산 하이퍼미디어 시스템을 위한 소프트웨어 아키텍처의 한 형식
- 로이 필딩의 2000년 박사 학위 논문에서 소개되었다.
- REST는 네트워크 아키텍처 원리의 모음
  - 네트워크 아키텍처 원리 : 자원을 정의하고 자원에 대한 주소를 지정하는 방법 전반을 일컫는다.
  - 간단히, 웹 상의 자료를 HTTP 위에 SOAP이나 쿠키를 통한 세션 트랙킹 같은 별도의 전송 계층 없이 전송하기 위한 아주 간단한 인터페이스를 의미한다.
- 필딩의 REST 원리를 따르는 시스템은 종종 RESTful이란 용어로 지칭된다.

### REST의 7가지 제약 조건

1. **Starting with the Null Style**

2. **Client-Server** : 아키텍처를 단순화시키고 작은 단위로 분리(decouple)함으로써 클라이언트-서버의 각 파트가 독립적으로 개선될 수 있도록 해준다.

3. **Stateless** : 각 요청 간 클라이언트의 콘텍스트가 서버에 저장되어서는 안된다.

4️. **Cacheable** : WWW에서와 같이 클라이언트는 응답을 캐싱할 수 있어야 한다.

5. **인터페이스 일관성 - Uniform Interface → 핵심!**

- 필딩 제약 조건
  - Uniform interface를 위해서 REST는 4가지 Interface 제약을 걸었다. 이 제약들을 '필딩 제약 조건'이라 한다. (논문 쓴 사람이 로이 필딩)
    - Four interface Constraints
      1.  자원의 식별(Identification of Resources)
          - 리소스들을 식별할 때 URI 등으로 할 수 있다.
      2.  메시지를 통한 리소스의 조작\*(Manipulation opf Resoruces through Representations)
          - 표현(HTTP Method)으로 리소스를 조작한다.
      3.  자기서술적 메시지(Self-descriptive Messages)
          - 메시지는 자기서술적이기 때문에 여러 레이어에서 처리/변환이 가능하다.
          - JSON 같은 범용 포맷을 작게 사용하면, 어떻게 해석해야 하는 지 알 수 없기 때문에 자기서술적이기 어렵다.
            뒤에서 다룰 MIME 타입으로 설명한다면, application/json이 아니라 application/dns+json 같은 타입을 써야한다.
          - REST API를 이야기할 때 가장 까다로운 부분 중 하나
          - 자기서술적이라는 것은 어떤 의미일까?
            - 프로그램 입장에서는 메시지가 어떤 의미인지 알 수 없다.
      4.  애플리케이션의 상태에 대한 엔진으로서 하이퍼미디어(Hypermedia as the Engine of Application State(HATEOAS))
          - REST API를 이야기할 때 까다로운 부분 중 하나
      - 업계에서 3,4번은 안지키는 경우도 많다.

6. **Layered System - 계층화**

- 인터넷 규모를 감당하고자 여러개의 레이어 시스템 제약을 두었음

7. **Code-On-Demand**

- REST는 API를 위한 아키텍처 스타일은 아니다. 논문에서 밝힌 것처럼 "common case of the WEB"에 특화된 방법이다. 하지만 일종의 표준을 제공하기 때문에 REST를 조금만 따르면 API를 만들 때 유용할 수 있다.

# 참고자료

- https://www.youtube.com/watch?v=RP_f5dMoHFc
- [https://blog.npcode.com/2017/03/02/바쁜-개발자들을-위한-rest-논문-요약/](https://blog.npcode.com/2017/03/02/%eb%b0%94%ec%81%9c-%ea%b0%9c%eb%b0%9c%ec%9e%90%eb%93%a4%ec%9d%84-%ec%9c%84%ed%95%9c-rest-%eb%85%bc%eb%ac%b8-%ec%9a%94%ec%95%bd/)
- [https://blog.npcode.com/2017/04/03/rest의-representation이란-무엇인가/](https://blog.npcode.com/2017/04/03/rest%ec%9d%98-representation%ec%9d%b4%eb%9e%80-%eb%ac%b4%ec%97%87%ec%9d%b8%ea%b0%80/)
