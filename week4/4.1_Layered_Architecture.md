Layered Architecture

## 관심사의 분리(SoC, Separation of Concerns)

### 용어의 정의

관심사의 분리란 컴퓨터 프로그램을 구별된 부분으로 분리시키는 디자인 원칙으로 각 부문은 개개의 관심사를 해결한다.

관심사란 컴퓨터 프로그램 코드에 영향을 미치는 정보의 집합이다. 관심사 분리를 이용하면 프로그램의 설계, 배포, 운영의 일부 관점에 더 높은 자유가 생긴다. 이 가운데 일반적인 것은 코드의 단순화 및 유지보수의 높은 자유도이다.

관심사 분리는 추상화의 일종이다. 대부분의 추상화에서처럼 인터페이스의 추가는 필수이며 실행에 쓰이는 더 순수한 코드가 있는 것이 일반적이다.

### 관심사의 분리 - 관련 개념

관심사의 분리(Separation of Concerns, SoC)는 소프트웨어 설계의 중요 원칙 중 하나이다. 이 원칙은 복잡한 프로그램을 더 관리하기 쉬운 부분으로 나누어 개발하는 것을 목표로 한다. 여기서 응집도와 결합도는 SoC를 구현하는데 있어 핵심적인 개념이다.

#### 응집도(Cohesion)

응집도는 하나의 모듈이나 클래스가 얼마나 긴밀하게 연관된 기능들을 가지고 있는지를 나타내는 척도이다. 높은 응집도를 가진 모듈은 잘 정의된 목적을 가지고 있으며, 그 안에 있는 모든 기능이 이 목적과 밀접하게 관련되어 있다. 응집도가 높다는 것은 좋은 설계의 징표로, 변경이 필요할 때 다른 부분에 미치는 영향을 최소화하고 유지보수를 용이하게 한다.

#### 결합도(Coupling)

결합도는 두 모듈이나 클래스가 얼마나 서로 의존하고 있는지를 나타내는 척도이다. 낮은 결합도는 각 모듈이나 클래스가 서로 독립적으로 존재할 수 있음을 의미하며, 다른 모듈에 대한 의존성이 적다. 낮은 결합도는 유연성과 재사용성을 증가시키며, 시스템의 한 부분을 변경할 때 다른 부분에 미치는 영향을 줄여준다.

#### SoC와의 관계

관심사의 분리를 통해 우리는 시스템을 여러 관심사로 분리하여 각각을 독립적으로 관리할 수 있다. 이 과정에서 **응집도를 높이고 결합도를 낮추는 것이 목표**이다. 높은 응집도는 각 부분이 하나의 관심사에만 집중하도록 만들며, 낮은 결합도는 이러한 부분들이 서로 독립적으로 유지될 수 있도록 도와준다. 이렇게 함으로써, 시스템은 더욱 모듈화되고, 유지보수가 쉬워지며, 확장성이 향상된다.

## Layered Achitecture

### 웹과 기능

웹 : UI -> UI Layer
기능 : Business Logic -> 도메인 계층

### Layered Achitecture - 용어의 정의

### Layered Achitecture - 사례

1. 전통적인 3계층
2. 에릭 에반스의 “DDD”에 나온 4계층
3. DIP를 적용한 4계층

## 다층구조

### 다층구조 - 용어의 정의

다층 구조(Multi-tier Architecture 또는 n-tier Architecture)는 비즈니스 로직을 완전히 분리하여 데이터베이스 시스템과 클라이언트의 사이에 배치한 클라이언트 서버 시스템의 일종이다.

### 다층구조 - 일반적 용례

일반적으로는 3층 구조가 널리 쓰이는데, 여기서 세 개의 층이란 아래와 같다.

1. 프레젠테이션 계층 - 사용자 인터페이스
2. 도메인 혹은 애플리케이션 계층 - 비즈니스 로직
3. 데이터 계층 - 데이터 베이스

## Identifier 전략

### UUID (범용 고유 식별자, universally unique identifier)

UUID란 네트워크 상에서 중복되지 않는 ID를 만들기 위한 표준 규약이다. 로컬에서 ID를 관리한다면 어떤 아이디들이 생성되었는지 확인한 후 중복을 체크하는 것이 가능하지만, 네트워크 상에서는 이야기가 다르다.

네트워크는 ID를 관리하는 중앙 관리자가 없기 때문에, 중복 확인이 불가능하다. 따라서 네트워크 상에서 중복되지 않는 ID를 만들려면 중복되는 확률이 0에 가까운, 매우 낮은 확률을 가지는 ID를 만드는 방법을 사용해야 한다.

중복되는 확률이 0에 가까운, 매우 낮은 확률을 가지는 ID를 만드는 방법을 표준화한 것이 바로 UUID이다. UUI는 계속해서 생성해도 중복이 생길 가능성이 0에 가깝다.

### ULID (Sortable 한 identifier)

#### ULID의 등장배경

UUID를 사용하게 되면 정렬 없이 무작위의 값을 생성해낸다. 그러면 어떤 식별자가 먼저 만들어진건지 알 수 없기 때문에 식별자가 정렬될 수 있도록 ULID가 등장하게 됐다.

### TSID (Time-Sorted Unique Identifiers)

ULID 라이브러리와 동일한 개발자가 ULID를 개선한 식별자 생성기
시간 순으로 정렬한다.

# Refactoring

## Extract Method - 함수 추출

함수 추출은 함수를 정의할 때, 각 기능들이 코드가 길고 읽기 어렵다면 그 기능을 함수로 추출하는 방법이다.

## Extract Class - 클래스 추출

두 개의 클래스가 해야 할 일을 하나의 클래스가 하고 있는 경우에, 새로운 클래스를 만들어서 관련있는 필드와 메소드를 새로운 클래스로 옮기는 행위

## Service

_Presentation Domain Data Layering_

각 기능을 개별 메서드로 분리하고 이를 모아서 PostService 클래소 모아주고, 다시 application 패키지로 옮기기

관심사의 분리에 따라서 코드도 분리한다.
코드를 어떻게 배치하는 지를 고민하는 것이 설계이며 설계를 개선하는 것이 리팩터링이다.
